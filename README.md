# Тестовое задание Verme

## Установка
* Создать виртуальное окружение
* Установить пакеты из `requirements.txt`
* Скопировать `wfm/.env.template` в `wfm/.env`
* Выполнить миграции 

## Запуск тестов
```
pytest orgunits/tests/models/
pytest orgunits/tests/views/
pytest orgunits/tests/optimization/
```

## Задание
* Запустить тесты и посмотреть, какие падают
* Доработать API views и методы Queryset моделей для приложения orgunits
* Добиться, чтобы как можно больше тестов проходили успешно

Виды тестов:
* **Тесты моделей** - Начать следует с тестов на модели, 
с их помощью разработать методы модели
* **Тесты на API** - Затем можно перейти к тестам API, 
они не будут проходить до тестов на модели
* **Тесты на оптимизацию** - Тесты на количество запросов 
к БД считаются дополнительными и повышают результат

## Примечания
Тесты на получение родителей и потомков объекта не покрывают ситуаций с деревьями глубина которых больше 3. Таким образом можно написать запрос, который будет возвращать некорректный список для корня четвертого уровня и глубже и пройти при этом тесты (в т.ч. на оптимизацию).

Получение предков/потомков выполнено одним рекурсивным sql запросом с помощью RawSQL. id корня передается как параметр запроса во избежание возможного внедрения sql кода. Название таблицы прописано в запросе вручную, так как sqlite не позволяет передавать названия таблиц в качестве параметров запроса.
